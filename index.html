function toggleOption(optionId) {
    const checkbox = document.getElementById(optionId);
    const optionItem = checkbox.closest('.option-item');
    
    checkbox.checked = !checkbox.checked;
    
    if (checkbox.checked) {
        optionItem.classList.add('active');
    } else {
        optionItem.classList.remove('active');
    }

    // Hanya periksa opsi wajib jika mengubah lowercase, uppercase, numbers, atau symbols
    const requiredOptions = ['lowercase', 'uppercase', 'numbers', 'symbols'];
    if (requiredOptions.includes(optionId)) {
        const selectedCount = requiredOptions.filter(id => document.getElementById(id).checked).length;
        if (selectedCount === 0) {
            checkbox.checked = true;
            optionItem.classList.add('active');
            alert('At least one character type must be selected!');
        }
    }

    // Perbarui password jika ada perubahan
    if (currentPassword) {
        generateBtn.click();
    }
}

function getSelectedCharacters() {
    let chars = '';
    
    if (document.getElementById('lowercase').checked) {
        chars += characterSets.lowercase;
    }
    if (document.getElementById('uppercase').checked) {
        chars += characterSets.uppercase;
    }
    if (document.getElementById('numbers').checked) {
        chars += characterSets.numbers;
    }
    if (document.getElementById('symbols').checked) {
        chars += characterSets.symbols;
    }

    // Hapus karakter yang mirip jika opsi enabled
    if (document.getElementById('similar').checked) {
        chars = chars.split('').filter(char => !similarChars.includes(char)).join('');
    }

    // Hapus karakter ambigu jika opsi enabled
    if (document.getElementById('ambiguous').checked) {
        chars = chars.split('').filter(char => !ambiguousChars.includes(char)).join('');
    }

    return chars || characterSets.lowercase + characterSets.uppercase; // Fallback minimal
}
